<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Asegura responsividad -->
    <title>Libro Digital Interactivo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Evita barras de desplazamiento */
        }
        #buttonContainer {
            position: absolute;
            top: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            text-align: center;
            padding: 10px 0;
            background-color: #bdedf1;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            font-size: 11px;
            cursor: pointer;
            background-color: #93f2ff;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover {
            background-color: #13e0eb;
        }

        #subtitles {
            display: none;
            position: absolute;
            bottom: 0;
            width: 100%;
            text-align: center;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 10px;
        }
    
        /* Ocultar el botón 'Iniciar' en pantallas grandes */
        #startButton {
            display: none; /* Oculta por defecto el botón */
        }
    
        /* Mostrar el botón 'Iniciar' solo en dispositivos móviles (pantallas pequeñas) */
        @media (max-width: 768px) {
            #startButton {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                display: block; /* Mostrar solo en pantallas pequeñas */
                z-index: 10;
                padding: 15px 30px; /* Tamaño más grande para facilitar la interacción */
                font-size: 20px; /* Fuente más grande para mejor visibilidad en móviles */
            }
        }

        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('destino.png') center center no-repeat;
            background-size: 30%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 24px;
            z-index: 100;
        }
    </style>
    
    
</head>
<body>

    <div id="loadingScreen">Cargando...</div>



    <div id="buttonContainer">

        <button id="prevButton">Anterior</button>
        <button id="nextButton">Siguiente</button>
        <button id="restartButton">Reiniciar Juego</button>
        <button id="newGameButton">Collage</button>
        <button id="subtitleButton">Misión</button>
    </div>
        <button id="startButton">Iniciar</button>


        <button id="collageButton" style="display: none; position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%); background: url('path_to_your_button_image.jpg') no-repeat center; border: none; width: 50px; height: 100px; cursor: pointer;">
            <img src="insects.png" alt="" >
        </button>


        
   
    <div id="subtitles" style="display:none;">
       Tu misión es recolectar la miel para ayudar a la abejas a migrar a sus destinos
    </div>

   


<script>


let audioInitialized = false;

function initGame() {
    if (!audioInitialized) {
        getAudioContext().resume().then(() => {
            console.log('Audio activado');
            audioInitialized = true;
            startNarration();
            document.getElementById('startButton').style.display = 'none'; // Oculta el botón de inicio después de activar el audio
        }).catch(err => {
            console.error('Error al activar el audio:', err);
        });
    } else {
        startNarration();
    }
}

window.onload = function() {
    // Mostrar el botón 'Iniciar' solo después de que la página haya cargado completamente
    var startButton = document.getElementById('startButton');
    if (startButton) {
        startButton.style.display = 'block'; // Asegúrate de que este estilo sobrescriba cualquier otro que pueda ocultarlo inicialmente
        startButton.addEventListener('click', function() {
            this.style.display = 'none'; // Ocultar el botón después de ser presionado
            startGame(); // Función que inicia el juego y la narración
        });
    }
};


function startNarration() {
    console.log("Narración iniciada");
    if (narrationTracks && narrationTracks[0]) {
        currentNarration = narrationTracks[0];
        currentNarration.play(); // Inicia la narración para la primera etapa
    }
    startGame(); // Inicia el juego, como la configuración de los boids
}

function startGame() {
    console.log("El juego ha comenzado");
    initFlock();  // Inicia la configuración de los boids
}

document.addEventListener('DOMContentLoaded', function() {
    var startButton = document.getElementById('startButton');
    startButton.addEventListener('click', initGame);
});

window.onload = function() {
    // Ocultar la pantalla de carga una vez que todo esté completamente cargado
    var loadingScreen = document.getElementById('loadingScreen');
    if (loadingScreen) {
        loadingScreen.style.display = 'none';
    }

    // Mostrar el botón 'Iniciar' solo en dispositivos móviles
    var startButton = document.getElementById('startButton');
    if (window.innerWidth <= 768) {
        if (startButton) {
            startButton.style.display = 'block'; // Mostrar el botón en dispositivos móviles
            startButton.addEventListener('click', function() {
                this.style.display = 'none'; // Ocultar el botón después de ser presionado
                startGame(); // Función que inicia el juego y la narración
            });
        }
    } else {
        if (startButton) {
            startButton.style.display = 'none'; // Asegúrate de que el botón no se muestre en dispositivos de escritorio
        }
    }
};


</script>
<script src="abejas.js"></script>

</body>
</html> 
