<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="ideofónica - Habitad Sonoro">
    <meta name="keywords" content="libro interactivo para niños , sonido,">
    <meta name="author" content="alfonsopretelt">
    <meta name="robots" content="collage">
    <meta name="google" content="translate">
    <meta property="og:type" content="https://ideofxnica.netlify.app/">
    <meta property="og:url" content="https://ideofxnica.netlify.app/">
    <meta property="og:title" content="Arte & Psique">
    <meta property="og:description" content="Plataforma de aprendizaje y creación">
    <link rel="icon" href="rostro.jpg" type="image/x-icon">
    <meta property="og:image" content="log.png">
    <title>ART & PSYCHE</title>
    <script src="https://cdn.jsdelivr.net/npm/interactjs@1.10.11/dist/interact.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/RecordRTC/5.6.1/RecordRTC.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anta&family=Kode+Mono:wght@400..700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/boxicons@2.0.7/css/boxicons.min.css" rel="stylesheet">

    <style>
        body {
            font-family: "Anta", sans-serif;
            margin: 0;
            background-color: #f2f2f2;
            overflow-x: hidden;
        }

        #buttonContainer {
            position: fixed;
            top: 0;
            width: 100%;
            text-align: center;
            padding: 10px 0;
            background-color: #bdedf1;
            z-index: 1000;
        }

      button {
        margin: 5px;
        padding: 10px 15px;
        font-size: 11px;
        cursor: pointer;
        background-color: #5cecff58;
        color: rgb(101, 102, 102);
        border: none;
        border-radius: 5px;
        z-index: 6000;
        text-shadow: 0 4px 20px rgba(rgb(4, 4, 4)); 
        box-shadow: 0 4px 20px rgb(170, 171, 144);


    }
    button:hover {
        background-color: #eaeded;
        box-shadow: 0 9px 20px rgba(white); 

    }
    
        @media (max-width: 768px) {
            button {
                padding: 8px 10px;
                font-size: 11px;
            }
        }

        .gallery-container {
            position: fixed;
            top: 60px;
            left: 0;
            bottom: 0;
            width: 100px;
            overflow-y: auto;
            background-color: #ffea00;
            padding: 10px 0;
            z-index: 1000;
            border: dashed #bdbdbd;
        }

        .gallery-container img {
            width: 80%;
            margin: 10px 10%;
            cursor: pointer;
            display: block;
        }

        @media (max-width: 768px) {
            .gallery-container {
                width: 50px;
            }

            .gallery-container img {
                width: 100%;
                margin: 5px 0;
            }
        }

        .main-content {
            margin-left: 110px;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        @media (max-width: 768px) {
            .main-content {
                margin-left: 60px;
                padding: 10px;
            }
        }

        footer {
            text-align: center;
            padding: 5px 0;
            background-color: transparent;
            color: #bffa6c;
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        footer:hover {
            color: #000000;
            text-decoration: none;
        }

        .print-button {
            margin: 50px auto;
            padding: 5px 10px;
            background-color: #e1e1e5;
            color: rgb(68, 68, 68);
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .print-button:hover {
            background-color: #b2eef3;
        }

        .image-controls-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .image-controls button {
            margin: 5px;
            padding: 10px;
        }

        .button-active {
            background-color: #bffa88;
        }

        button:focus, .button-class:focus {
            outline: none;
            background-color: #ebebeb;
        }

        .no-scroll {
            touch-action: none;
        }

        @media screen and (orientation: portrait) {
            .main-content {
                margin-top: 20px;
                text-align: center;
            }

            .image-controls-container {
                flex-direction: column;
            }
        }

        @media screen and (orientation: landscape) {
            .main-content {
                padding: 10px;
            }

            .image-controls-container {
                flex-direction: row;
                justify-content: space-around;
            }
        }

        .color-palette {
            display: flex;
            flex-wrap: wrap;
            width: 200px;
            margin: 5px;
        }

        .color-swatch {
            width: 20px;
            height: 20px;
            margin: 2px;
            cursor: pointer;
            border: 1px solid #ddd;
        }

        .color-swatch.selected {
            border: 2px solid #000;
        }

        h4{
font-size: 21px;
    color: #bdedf1;
    text-shadow: 0 4px 20px rgb(10, 123, 95);
}
    </style>
</head>

<body>

<header>
    <div id="buttonContainer">
        <button id="storyButton">Cuento</button>
        <button id="misionButton">Misión</button>
        <button id="newGameButton">Viaje de las Abejas</button>
        <button id="collageButton">Collage</button>
            <img style="width: 7%" src="logo.webp" alt="" class="w-30 h-22 2xl:w-28 2xl:h-29 object-cover">
<h4>ideofónica</h4>
        </div>

    
    </div>
</header>

<div class="gallery-container">
    <img src="01.svg" alt="01" data-svg="01.svg">
    <img src="02.svg" alt="2" data-svg="02.svg">
    <img src="03.svg" alt="3" data-svg="03.svg">
    <img src="04.svg" alt="4" data-svg="04.svg">
    <img src="05.svg" alt="5" data-svg="05.svg">
    <img src="06.svg" alt="6" data-svg="06.svg">
    <img src="07.svg" alt="7" data-svg="07.svg">
    <img src="8.svg" alt="8" data-svg="08.svg">
</div>

<div class="main-content">
    <div id="svgContainer"></div>
</div>

<div class="image-controls-container">
    <div class="image-controls">
        <button onclick="resizeImage(1.1)">-</button>
        <button onclick="resizeImage(0.9)">+</button>
        <div class="color-palette" id="colorPalette"></div>
        <button id="togglePaintMode"><i class='bx bx-paint button-hover-effect'></i></button>
        <button id="toggleDragMode"><i class='bx bx-move button-hover-effect'></i></button>
        <button onclick="printDocument()" class="print-button"><i class='bx bx-printer'></i></button>
    </div>
</div>

<script>
let paintHistory = [];
let paintMode = false;
let currentColor = '#000000';

function loadSVGAndAddInteractivity(svgFile) {
    const xhr = new XMLHttpRequest();
    xhr.open('GET', svgFile, true);
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
            const container = document.getElementById('svgContainer');
            container.innerHTML = xhr.responseText;
            applyInteractivity();
        }
    };
    xhr.send();
}

function applyInteractivity() {
    document.querySelectorAll('#svgContainer svg path').forEach(path => {
        path.addEventListener('click', function() {
            if (!paintMode) {
                const prevState = {
                    type: 'fill',
                    element: this,
                    fill: this.style.fill
                };
                paintHistory.push(prevState);
                this.style.fill = currentColor;
            }
        });
    });
}

document.querySelectorAll('.gallery-container img').forEach(img => {
    img.addEventListener('click', function() {
        const svgPath = this.getAttribute('data-svg');
        loadSVGAndAddInteractivity(svgPath);
    });
});

window.addEventListener('load', () => {
    const firstSVGImage = document.querySelector('.gallery-container img');
    if (firstSVGImage) {
        const firstSVGPath = firstSVGImage.getAttribute('data-svg');
        loadSVGAndAddInteractivity(firstSVGPath);
    }
    populateColorPalette();
});

function resizeImage(scaleFactor) {
    const svg = document.querySelector("#svgContainer svg");
    if (svg) {
        const currentWidth = svg.viewBox.baseVal.width || svg.getBoundingClientRect().width;
        const currentHeight = svg.viewBox.baseVal.height || svg.getBoundingClientRect().height;

        const newWidth = currentWidth * scaleFactor;
        const newHeight = currentHeight * scaleFactor;

        svg.viewBox.baseVal.width = newWidth;
        svg.viewBox.baseVal.height = newHeight;
        svg.setAttribute("width", newWidth + "px");
        svg.setAttribute("height", newHeight + "px");

        console.log("SVG redimensionado a:", newWidth, newHeight);
    }
}

let isDraggable = false;
function toggleDragMode() {
    isDraggable = !isDraggable;
    const button = document.getElementById("toggleDragMode");

    interact("#svgContainer svg").draggable({
        enabled: isDraggable,
        listeners: {
            move(event) {
                if (!isDraggable) return;
                
                let target = event.target,
                    x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
                    y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                
                target.style.transform = `translate(${x}px, ${y}px)`;
                target.setAttribute('data-x', x);
                target.setAttribute('data-y', y);
            }
        }
    });

    if (isDraggable) {
        button.classList.add("button-active");
    } else {
        button.classList.remove("button-active");
    }
}

document.getElementById("toggleDragMode").addEventListener("click", toggleDragMode);

function togglePaintMode() {
    paintMode = !paintMode;
    const button = document.getElementById("togglePaintMode");

    if (paintMode) {
        activatePainting();
        button.classList.add("button-active");
    } else {
        deactivatePainting();
        button.classList.remove("button-active");
    }
}

function activatePainting() {
    const svgContainer = document.getElementById("svgContainer");
    svgContainer.addEventListener('mousemove', paint);
    svgContainer.addEventListener('touchmove', paint, {passive: false});
}

function deactivatePainting() {
    const svgContainer = document.getElementById("svgContainer");
    svgContainer.removeEventListener('mousemove', paint);
    svgContainer.removeEventListener('touchmove', paint);
}

function paint(event) {
    event.preventDefault();
    if (!paintMode) return;

    let clientX, clientY;
    if (event.touches) {
        clientX = event.touches[0].clientX;
        clientY = event.touches[0].clientY;
    } else {
        clientX = event.clientX;
        clientY = event.clientY;
    }

    const svg = document.querySelector("#svgContainer svg");
    const pt = svg.createSVGPoint();
    pt.x = clientX;
    pt.y = clientY;
    const svgPoint = pt.matrixTransform(svg.getScreenCTM().inverse());
    
    const color = currentColor;

    let newElement = document.createElementNS("http://www.w3.org/2000/svg", "circle");
    newElement.setAttribute("cx", svgPoint.x);
    newElement.setAttribute("cy", svgPoint.y);
    newElement.setAttribute("r", 2);
    newElement.setAttribute("fill", color);

    svg.appendChild(newElement);
    paintHistory.push(newElement);
}

function undoPaint() {
    if (paintHistory.length > 0) {
        const lastAction = paintHistory.pop();
        if (lastAction.type === 'fill') {
            lastAction.element.style.fill = lastAction.fill;
        } else if (lastAction.type === 'draw') {
            lastAction.element.remove();
        }
    }
}

document.addEventListener("keydown", function(event) {
    if (event.ctrlKey && event.key === 'z') {
        undoPaint();
    }
});

document.getElementById("togglePaintMode").addEventListener("click", function(e) {
    e.preventDefault();
    togglePaintMode();
});

document.getElementById("togglePaintMode").addEventListener("touchstart", function(e) {
    e.preventDefault();
    togglePaintMode();
});

document.getElementById('newGameButton').addEventListener('click', function() {
    window.location.href = 'index.html';
});

document.getElementById('collageButton').addEventListener('click', function() {
    window.location.href = 'collage.html';
});

function printDocument() {
    window.print();
}

if ('addEventListener' in document) {
    document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body);
    }, false);
}

function populateColorPalette() {
    const colors = [
        '#ff0000', '#ff7f00', '#ffff00', '#00ff00', '#0000ff', '#4b0082', '#8f00ff', // ROYGBIV
        '#ffffff', '#000000', '#808080', '#800000', '#808000', '#008000', '#800080', '#008080', '#000080'
    ];

    const colorPalette = document.getElementById('colorPalette');

    colors.forEach(color => {
        const colorSwatch = document.createElement('div');
        colorSwatch.className = 'color-swatch';
        colorSwatch.style.backgroundColor = color;
        colorSwatch.addEventListener('click', () => {
            currentColor = color;
            document.querySelectorAll('.color-swatch').forEach(swatch => swatch.classList.remove('selected'));
            colorSwatch.classList.add('selected');
        });
        colorPalette.appendChild(colorSwatch);
    });
}
</script>

</body>
</html>


